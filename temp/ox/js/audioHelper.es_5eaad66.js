define("wiki-lemma:widget/feature/Audio/tools/audioHelper.es",function(e,t,a){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){return p["default"](e).attr("data-pid",t)}function n(e){return"para-title"===p["default"](e).attr("label-module")}function u(e){return("para"===p["default"](e).attr("label-module")||p["default"](e).hasClass("para-list"))&&f(e)}function l(e,t){if(e){var a=function(){var a=h["default"](e.trim().replace(/\s+/g," ")).split(" "),r=t.split(""),i=r.map(function(e,t){return/[\u4e00-\u9fa5]/.test(e)?e+"("+a[t]+")":e});return{v:i.join("")}}();if("object"==typeof a)return a.v}}function o(e,t,a){if(e){var r=l(e,t),i=new RegExp("("+t+"|"+e.trim()+")","gi");return a.replace(i,r)}return a}function d(e,t){var a=e&&l(e,t);return e?[a]:[t]}function c(e,t,a){var r=f(e,t,a);return s(r)}function f(e,t,a){var r=p["default"](e).clone();n(e)&&r.find('span[class="title-prefix"]').remove();var i=r.find("sup").remove().end().find(".J-lemma-album").remove().end().find(".J-lemma-picture").remove().end().text().replace(/\s/g," ").trim();return i=i.replace(/[（][^）)]+[\）)]|[(][^）)]+[\))]/g,""),a&&(i=o(a,t,i)),i}function s(e){var t=arguments.length<=1||void 0===arguments[1]?100:arguments[1],a=arguments.length<=2||void 0===arguments[2]?50:arguments[2];if(""===e)return"";e.replace(/"|'/g,"");var r=[];return e.length>a?!function(){var i=[],n=["、","，","；","？","！","：","。"];i=e.split(new RegExp(/(、|，|；|？|！|：|。)/g)),i.forEach(function(e,t){i[t+1]&&n.indexOf(i[t+1])>-1&&(i[t]+=i[t+1],i[t+1]="")});var u="";i.forEach(function(e){if(""!==e){var i=e+u;0===r.length?i.length>=a&&""!==u?(r.push(u),u=e):u+=e:i.length>t?(r.push(u),u=e):u+=e}}),u&&(r.push(u),u="")}():r=[e],r}function m(e){var t=e.lemmaTitle,a=e.pinyin,r=e.catalog,l=e.extData,s=p["default"](".J-lemma-title"),m=p["default"]('[label-module="lemmaSummary"]'),g=p["default"](".J-basic-info"),v=p["default"](".J-content").find(".curTab").length?p["default"](".J-content").find(".curTab"):p["default"](".J-content"),h=[],y=0,b=0,x=void 0,C=void 0,A=0;return h.push({pid:y,catalogPid:void 0,catalogName:"标题",voice:d(a,t)}),i(s,y),y++,A+=t.length,m.children().each(function(e,r){if(p["default"](r).hasClass("para")&&p["default"](r).attr("label-module")){i(r,y);var n=c(r,t,a);h.push({pid:y,catalogPid:C,catalogName:"概述",voice:n}),y++,A+=w.getStrArrayCount(n)}}),l.card&&l.card.length&&!function(){i(g,"card");var e=new RegExp("[（][^）)]+[）)]|[(][^）)]+[))]","gi"),r=l.card.map(function(r){return o(a,t,r.replace(e,""))});h.push({pid:"card",catalogPid:C,catalogName:"基本信息栏",voice:r}),A+=w.getStrArrayCount(l.card)}(),v.children().each(function(e,d){if(n(d)&&(x=r.length>0?o(a,t,r[b].title):f(d),i(d,y),(1===r[b].level||p["default"](d).hasClass("level-2"))&&(C=y),h.push({pid:y,catalogPid:C,catalogName:x,voice:[x]}),b++,y++,A+=w.getStrArrayCount([x])),u(d)){i(d,y);var s=c(d,t,a);h.push({pid:y,catalogPid:C,catalogName:x,voice:s}),y++,A+=w.getStrArrayCount(s)}p["default"](d).attr("audio-id")&&l.modules&&l.modules[p["default"](d).attr("audio-id")]&&l.modules[p["default"](d).attr("audio-id")].hasVoice&&!function(){i(d,y);var e=p["default"](d),r=e.attr("audio-id"),n=e.attr("data-name"),u=l.modules[r],c=n?u.arrVoice[n]:u.arrVoice,f=new RegExp("[（][^）)]+[）)]|[(][^）)]+[))]","gi"),s=c.map(function(e){return o(a,t,e.replace(f,""))});h.push({pid:y,catalogPid:C,catalogName:x,voice:s}),y++,A+=w.getStrArrayCount(s)}()}),{voiceData:h,letterCount:A}}Object.defineProperty(t,"__esModule",{value:!0});var g=e("wiki-common:widget/lib/jquery/jquery"),p=r(g),v=e("wiki-lemma:widget/feature/Audio/tools/pinyin.es"),h=r(v),w=e("wiki-lemma:widget/feature/Audio/tools/utils.es");t["default"]=m,a.exports=t["default"]});